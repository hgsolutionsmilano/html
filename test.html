<!doctype html>
 <html lang="it">
   <head>
     <title>CPL Support IA</title>
     <!--
       This styling is for the Web Chat demonstration purposes.
       It is recommended that style is moved to a separate file for organization in larger projects.

       Please visit https://github.com/microsoft/BotFramework-WebChat for details about Web Chat.
     -->
     <style>
       html,
       body {
         height: 100%;
       }

       body {
         margin: 0;
       }

       h1 {
         color: whitesmoke;
         font-family: Segoe UI;
         font-size: 16px;
         line-height: 20px;
         margin: 0;
         padding: 0 20px;
       }

       #banner {
         align-items: center;
         background-color: #8f00ff;
         display: flex;
         height: 50px;
       }

       #webchat {
         height: calc(100% - 50px);
         overflow: hidden;
         position: fixed;
         top: 50px;
         width: 100%;
       }
     </style>
   </head>
   <body>
     <div>
       <div id="banner">
         <h1>CPL Support IA</h1>
       </div>
       <div id="webchat" role="main"></div>
     </div>

     <!--
       In this sample, the latest version of Web Chat is being used.
       In production environment, the version number should be pinned and version bump should be done frequently.

       Please visit https://github.com/microsoft/BotFramework-WebChat/tree/main/CHANGELOG.md for changelog.
     -->
     <script crossorigin="anonymous" src="https://cdn.botframework.com/botframework-webchat/latest/webchat.js"></script>

     <script>
       (async function () {
         // Specifies style options to customize the Web Chat canvas.
         // Please visit https://microsoft.github.io/BotFramework-WebChat for customization samples.
         const styleOptions = {
           // Hide upload button.
           hideUploadButton: true,
		   accent: '#00809d',
							  botAvatarBackgroundColor: '#FFFFFF',
							  botAvatarImage: 'data:image/png;base64,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',
							  botAvatarInitials: 'BT',
							  userAvatarImage: 'https://www.cpl.it/wp-content/uploads/2024/01/full-light.svg',
						suggestedActionLayout: 'flow'
         };

         // Specifies the token endpoint URL.
         // To get this value, visit Copilot Studio > Settings > Channels > Mobile app page.
         const tokenEndpointURL = new URL('https://defaulta07360ef719c4e66af7be25f061273.f3.environment.api.powerplatform.com/powervirtualagents/botsbyschema/Default_cplSupportoIa/directline/token?api-version=2022-03-01-preview');

         // Specifies the language the agent and Web Chat should display in:
         // - (Recommended) To match the page language, set it to document.documentElement.lang
         // - To use current user language, set it to navigator.language with a fallback language
         // - To use another language, set it to supported Unicode locale

         // Setting page language is highly recommended.
         // When page language is set, browsers will use native font for the respective language.
	
							  


         const locale = document.documentElement.lang || 'en'; // Uses language specified in <html> element and fallback to English (United States).
         // const locale = navigator.language || 'ja-JP'; // Uses user preferred language and fallback to Japanese.
         // const locale = 'zh-HAnt'; // Always use Chinese (Traditional).

         const apiVersion = tokenEndpointURL.searchParams.get('api-version');

         const [directLineURL, token] = await Promise.all([
           fetch(new URL(`/powervirtualagents/regionalchannelsettings?api-version=${apiVersion}`, tokenEndpointURL))
             .then(response => {
               if (!response.ok) {
                 throw new Error('Failed to retrieve regional channel settings.');
               }

               return response.json();
             })
             .then(({ channelUrlsById: { directline } }) => directline),
           fetch(tokenEndpointURL)
             .then(response => {
               if (!response.ok) {
                 throw new Error('Failed to retrieve Direct Line token.');
               }

               return response.json();
             })
             .then(({ token }) => token)
         ]);

         // The "token" variable is the credentials for accessing the current conversation.
         // To maintain conversation across page navigation, save and reuse the token.

         // The token could have access to sensitive information about the user.
         // It must be treated like user password.

         const directLine = WebChat.createDirectLine({ domain: new URL('v3/directline', directLineURL), token });

         // Sends "startConversation" event when the connection is established.

         const subscription = directLine.connectionStatus$.subscribe({
           next(value) {
             if (value === 2) {
               directLine
                 .postActivity({
                   localTimezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                   locale,
                   name: 'startConversation',
                   type: 'event'
                 })
                 .subscribe();

               // Only send the event once, unsubscribe after the event is sent.
               subscription.unsubscribe();
             }
           }
         });

         WebChat.renderWebChat({ directLine, locale, styleOptions }, document.getElementById('webchat'));
       })();
     </script>
   </body>
 </html>
